import React, {useEffect, useState} from 'react';

import useFetch from 'hooks/use-fetch';
import CreateComment from "pages/create-comment";

const Comments = (props) => {
    const slug = props.match.params.slug;
    const apiUrl = `/articles/${slug}`;
    const [
        {
            response: fetchCommentResponse,
            error: fetchCommentError,
            isLoading: fetchCommentIsLoading
        },
        doFetch
    ] = useFetch(apiUrl);
    const [{response: deleteCommentResponse}, doDeleteComment] = useFetch(apiUrl);
    const [, setIsSuccessfulDelete] = useState(false);

    console.log("CommentsResponse", fetchCommentResponse);

    const deleteComment = () => {
        doDeleteComment({
            method: 'delete'
        })
    };

    useEffect(() => {
        doFetch();
    }, [doFetch]);

    useEffect(() => {
        if (!deleteCommentResponse) {
            return
        }
        setIsSuccessfulDelete(true);
    }, [deleteCommentResponse]);

    return (
        <div>
            {!fetchCommentIsLoading && fetchCommentResponse && (

                <CreateComment/>
            )}
        </div>
    )
};

export default Comments;